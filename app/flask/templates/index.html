{% extends 'base.html' %}

{% block content %}
<form method="post" id="loan-form">
  <select id="district" name="district" aria-label="Select your district..." required>
    <option selected disabled value="">
      Select your district...
    </option>
    {% for district in district_names %}
      <option>{{ district }}</option>
    {% endfor %}
  </select>
  <label for="balance">
    Balance
    <input 
      type="number" 
      id="balance" 
      name="balance" 
      placeholder="5000",
      aria-label="Number"
    >
  </label>
  <div><label for=""></label></div>
  <div class="grid">
    <label for="loan-amount">
      Loan Amount
      <input 
        type="number" 
        id="loan-amount" 
        name="loan-amount" 
        placeholder="10000",
        aria-label="Number"
      >
    </label>
    <label for="loan-duration">
      Loan Duration (Years)
      <input 
        type="number" 
        id="loan-duration" 
        name="loan-duration" 
        placeholder="10",
        aria-label="Number"
      >
      <small id="loan-duration-helper" style="visibility:hidden">Please provide numeric value</small>
    </label>
    <label for="loan-payments">
      Loan Payments
      <input 
        type="number" 
        id="loan-payments" 
        name="loan-payments" 
        placeholder="1000",
        aria-label="Number"
      >
      <small id="loan-payments-helper" style="visibility:hidden">Please provide numeric value</small>
    </label>
  </div>
  <div class="grid">
    <label for="transactions-date">
      Last Transaction Date
      <input type="date" id="transactions-date" name="transactions-date" aria-label="Date">
    </label>
    <label for="transaction-amount">
      Last Transaction Amount
      <input 
        type="number" 
        id="transaction-amount" 
        name="transaction-amount" 
        placeholder="200",
        aria-label="Number"
      >
      <small id="transaction-amount-helper" style="visibility:hidden">Please provide numeric value</small>
    </label>
    <label for="daily-transactions">
      Number of Daily Transactions
      <input 
        type="number" 
        id="daily-transactions" 
        name="daily-transactions" 
        placeholder="2",
        aria-label="Number"
      >
      <small>Based on past 3 months</small>
      <small id="daily-transactions-helper" style="visibility:hidden">Please provide numeric value</small>
    </label>
  </div>
  <div class="grid">
    <div></div>
    <button data-target="modal">Predict loan status!</button>
    <div></div>
  </div>
</form>
{% if show_modal %}
<dialog id="modal" open>
  <article>
    <header>
      <button id="close-dialog" aria-label="Close" rel="prev"></button>
      <h2>{{ loan_status }}</h2>
    </header>
    <p>
      We're excited to have you join us for our
      upcoming event. Please arrive at the museum 
      on time to check in and get started.
    </p>
    <ul>
      <li>Date: Saturday, April 15</li>
      <li>Time: 10:00am - 12:00pm</li>
    </ul>
  </article>
</dialog>
{% endif %}

{% endblock %}

{% block script %}
  <script src="{{url_for('static', filename='js/jquery-3.7.1.min.js')}}"></script>

  <script type="text/javascript">
    // $(document).on('submit','#loan-form',function(e)
    //                {
    //   e.preventDefault();
    //   $.ajax({
    //     type:'POST',
    //     url:'/',
    //     data:{
    //       "transactions-date": $("#transactions-date").val(),
    //       "loan-duration": $("#loan-duration").val(),
    //       "district": $("#district").val(),
    //       "loan-payments": $("#loan-payments").val(),
    //       "loan-amount": $("#loan-amount").val(),
    //       "balance": $("#balance").val(),
    //       "daily-transactions": $("#daily-transactions").val(),
    //       "transaction-amount": $("#transaction-amount").val()
    //     },
    //     success:function()
    //     {
    //       document.getElementById("modal").showModal()
    //     }
    //   })
    // });

    const closeDialogButton = document.getElementById('close-dialog')
    closeDialogButton.addEventListener("click", () => {
      document.getElementById("modal").close();
    })
  </script>
{% endblock %}