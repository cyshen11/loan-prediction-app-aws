{% extends 'base.html' %}

{% block content %}
<form method="post" id="loan-form">
  <select name="district" aria-label="Select your district..." required>
    <option selected disabled value="">
      Select your district...
    </option>
    {% for district in district_names %}
      <option>{{ district }}</option>
    {% endfor %}
  </select>
  <div><label for=""></label></div>
  <div class="grid">
    <label for="loan-amount">
      Loan Amount
      <input 
        type="text" 
        id="loan-amount" 
        name="loan-amount" 
        placeholder="10000",
        onChange="check_numeric(this)"
        aria-describedby="loan-amount-helper"
      >
      <small id="loan-amount-helper" style="visibility:hidden">Please provide numeric value</small>
    </label>
    <label for="loan-duration">
      Loan Duration (Years)
      <input 
        type="text" 
        id="loan-duration" 
        name="loan-duration" 
        placeholder="10",
        onChange="check_numeric(this)"
        aria-describedby="loan-duration-helper"
      >
      <small id="loan-duration-helper" style="visibility:hidden">Please provide numeric value</small>
    </label>
    <label for="loan-payments">
      Loan Payments
      <input 
        type="text" 
        id="loan-payments" 
        name="loan-payments" 
        placeholder="1000",
        onChange="check_numeric(this)"
        aria-describedby="loan-payments-helper"
      >
      <small id="loan-payments-helper" style="visibility:hidden">Please provide numeric value</small>
    </label>
  </div>
  <div class="grid">
    <label for="balance">
      Balance
      <input 
        type="text" 
        id="balance" 
        name="balance" 
        placeholder="5000",
        onChange="check_numeric(this)"
        aria-describedby="balance-helper"
      >
      <small id="balance-helper" style="visibility:hidden">Please provide numeric value</small>
    </label>
    <label for="daily-transactions">
      Number of Daily Transactions
      <input 
        type="text" 
        id="daily-transactions" 
        name="daily-transactions" 
        placeholder="2",
        onChange="check_numeric(this)"
        aria-describedby="daily-transactions-helper"
      >
      <small>Based on past 3 months</small>
      <small id="daily-transactions-helper" style="visibility:hidden">Please provide numeric value</small>
    </label>
    <label for="transactions-amount">
      Latest Transaction Amount
      <input 
        type="text" 
        id="transaction-amount" 
        name="transaction-amount" 
        placeholder="200",
        onChange="check_numeric(this)"
        aria-describedby="transaction-amount-helper"
      >
      <small id="transaction-amount-helper" style="visibility:hidden">Please provide numeric value</small>
    </label>
  </div>
  <div class="grid">
    <div></div>
    <button data-target="modal">Predict loan status!</button>
    <div></div>
  </div>
</form>
<dialog id="modal">
  <article>
    <header>
      <button id="close-dialog" aria-label="Close" rel="prev"></button>
      <h2>üóìÔ∏è Thank You for Registering!</h2>
    </header>
    <p>
      We're excited to have you join us for our
      upcoming event. Please arrive at the museum 
      on time to check in and get started.
    </p>
    <ul>
      <li>Date: Saturday, April 15</li>
      <li>Time: 10:00am - 12:00pm</li>
    </ul>
  </article>
</dialog>

{% endblock %}

{% block script %}
  <script src="{{url_for('static', filename='js/jquery-3.7.1.min.js')}}"></script>

  <script type="text/javascript">
    function check_numeric(element) {
      var is_val_numeric = isNaN(element.value)? true : false;
      var visibility = isNaN(element.value)? "visible" : "hidden";
      element.setAttribute("aria-invalid", is_val_numeric);
      document.getElementById(element.id + "-helper").style.visibility = visibility;
    }

    $(document).on('submit','#loan-form',function(e)
                   {
      e.preventDefault();
      $.ajax({
        type:'POST',
        url:'/',
        data:{
          todo:$("#todo").val()
        },
        success:function()
        {
          document.getElementById("modal").showModal()
        }
      })
    });

    const closeDialogButton = document.getElementById('close-dialog')
    closeDialogButton.addEventListener("click", () => {
      document.getElementById("modal").close();
    })
  </script>
{% endblock %}